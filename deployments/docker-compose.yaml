version: '2.0.0'
services:
    awca-mysql:
        container_name: awca-mysql
        image: mysql
        command: --default-authentication-plugin=mysql_native_password
        restart: always
        environment:
            - MYSQL_ROOT_PASSWORD=password
            - MYSQL_DATABASE=auth_with_clean_architecture
            - MYSQL_USER=username
            - MYSQL_PASSWORD=password
        volumes:
            - awca:/var/lib/mysql
            - ../docs:/docker-entrypoint-initdb.d
        networks:
            - awca
    awca-go:
        container_name: awca-go
        image: awca:2.0.0
        # restart: always
        build:
            context: ..
            dockerfile: deployments/Dockerfile
        ports:
            - 1337:8080
        environment:
            - DB_HOST=awca-mysql
            - DB_PORT=3306
            - DB_USERNAME=username
            - DB_PASSWORD=password
            - DB_DATABASE=auth_with_clean_architecture
            - JWT_KEY=awesome-secret-key
        networks:
            - awca
        depends_on:
            - awca-mysql
volumes:
    awca:
        driver: local
networks:
    awca:
        driver: bridge
